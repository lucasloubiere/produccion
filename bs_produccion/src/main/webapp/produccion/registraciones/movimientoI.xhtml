<ui:composition 
xmlns="http://www.w3.org/1999/xhtml"
xmlns:h="http://java.sun.com/jsf/html"
xmlns:f="http://java.sun.com/jsf/core"
xmlns:ui="http://java.sun.com/jsf/facelets"
xmlns:p="http://primefaces.org/ui" >
    
    <h:panelGroup style="width: 100%;">

            <p:tabView style="min-height: 350px;">

                <p:tab title="Items">

                    <p:dataTable id="detalle" value="#{movimientoProduccionBean.m.itemProducto}"
                                 var="p" scrollable="true" scrollHeight="200"
                                 emptyMessage="#{msgs.pcc_msgNoEncontraronProductos}">

                        <p:column headerText="Buscar" style="width: 60px; text-align: center;">
                            <p:commandButton icon="find16" rendered="#{empty p.producto}" oncomplete="dlg_producto.show()"  />
                        </p:column>

                        <p:column headerText="#{msgs.pcc_codigo}" style="width: 120px;">
                            <h:outputText value="#{p.producto.artcod}" rendered="#{not empty p.producto}"/>
                            <h:outputText value="#{buscadorProductoBean.producto.artcod}" rendered="#{empty p.producto}"  />
                        </p:column>

                        <p:column headerText="#{msgs.pcc_descripcion}" style="width: 380px;">
                            <h:outputText value="#{p.producto.descrp}"  rendered="#{not empty p.producto}"/>
                            <h:outputText value="#{buscadorProductoBean.producto.descrp}" rendered="#{empty p.producto}"  />                                                        
                        </p:column>
                        <p:column headerText="#{msgs.pcc_UM}" width="25" style="text-align: center;">
                            <h:outputText value="#{p.producto.unidadMedida.unidad}" rendered="#{not empty p.producto}" />
                            <h:outputText value="#{buscadorProductoBean.producto.unidadMedida.unidad}" rendered="#{empty p.producto}"  />
                        </p:column>

                        <p:column headerText="#{msgs.pcc_cantidad}" width="60">
                            <p:inputText value="#{p.cantid}" size="8" id="cantidad" style="text-align: right;" >
                                <f:convertNumber pattern="0.00" />                                
                            </p:inputText>
                        </p:column>

                        <p:column headerText="ComposiciÃ³n" style="width:100px; text-align: center;">
                            <p:rowToggler />
                        </p:column>

                        <p:rowExpansion>
                            <p:spacer height="5" />
                            <p:dataTable value="#{p.composicionFormula.itemComposicion}"
                                         var="c" style="margin: 5px; float: right;" >
                                
                                <p:column headerText="#{msgs.codigo}" style="width: 100px; ">
                                    <h:outputText value="#{c.productoComponente.artcod}"/>
                                </p:column>

                                <p:column headerText="#{msgs.descripcion}" style="width: 400px;">
                                    <h:outputText value="#{c.productoComponente.descrp}"/>
                                </p:column>

                                <p:column headerText="#{msgs.cantidad}" style="width: 80px;">
                                    <h:outputText value="#{c.cntnom}"/>
                                </p:column>

                                <p:column headerText="#{msgs.pcc_UM}" width="25" style="text-align: center;">
                                    <h:outputText value="#{c.unidadMedidaItem.unidad}"/>
                                </p:column>
                            </p:dataTable>
                            <p:spacer height="5" />
                        </p:rowExpansion>
                       
                        <p:column headerText="#{msgs.accion}" style="width: 60px; text-align: center;">
                            <p:commandButton rendered="#{empty p.producto}"
                                             actionListener="#{movimientoProduccionBean.agregarItem(p)}" icon="add16"
                                             update="@form"  />

                            <p:commandButton immediate="true" rendered="#{not empty p.producto}"
                                             actionListener="#{movimientoProduccionBean.elimitarItem(p)}" icon="delete16"
                                             process="@this"
                                             update="@form"  />
                        </p:column>

                    </p:dataTable>
                </p:tab>

                <p:tab title="Componentes necesarios">

                    <p:dataTable id="detalleMateriales" value="#{movimientoProduccionBean.m.itemComponente}"
                                 var="m" scrollable="true" scrollHeight="250"
                                 emptyMessage="#{msgs.no_encontro_materiales}">

                        <p:column headerText="#{msgs.pcc_codigo}" width="150" style="width: 150px;">
                            <h:outputText value="#{m.producto.artcod}" />
                        </p:column>
                        <p:column headerText="#{msgs.pcc_descripcion}" style="width: 500px;">
                            <h:outputText value="#{m.producto.descrp}" />
                        </p:column>
                        
                        <p:column headerText="#{msgs.pcc_cantidad}" style="width: 80px; text-align: right;">
                            <h:outputText value="#{m.cantid}" >
                                <f:convertNumber pattern=" 0.00" />
                            </h:outputText>
                        </p:column>

                        <p:column headerText="#{msgs.pcc_UM}" width="25" style="text-align: center;"">
                            <h:outputText value="#{m.unidadMedida.unidad}" />
                        </p:column>

                    </p:dataTable>
                    
                </p:tab>

                <p:tab title="Vale de Consumo" rendered="#{not empty parteProduccionBean.m.valeConsumo}">

                    <p:dataTable id="detalle" value="#{parteProduccionBean.m.valeConsumo.itemProducto}"
                                 var="p" scrollable="true" scrollHeight="200"
                                 emptyMessage="#{msgs.pcc_msgNoEncontraronProductos}">

                        <p:column headerText="#{msgs.pcc_codigo}" width="120">
                            <h:outputText value="#{p.producto.artcod}" rendered="#{not empty p.producto}"/>
                            <h:outputText value="#{buscadorProductoBean.producto.artcod}" rendered="#{empty p.producto}"  />
                        </p:column>

                        <p:column headerText="#{msgs.pcc_descripcion}" width="380" >
                            <h:outputText value="#{p.producto.descrp}"  rendered="#{not empty p.producto}"/>
                            <h:outputText value="#{buscadorProductoBean.producto.descrp}" rendered="#{empty p.producto}"  />
                        </p:column>

                        <p:column headerText="#{msgs.pcc_cantidad}" width="80">
                            <p:spinner value="#{p.cantid}" size="5" id="cantidad" min="1" >
                                <f:convertNumber pattern="0.00" />
                                <p:ajax listener="#{parteProduccionBean.actualizarCantidades}"
                                        update="cantidad"/>
                            </p:spinner>
                        </p:column>

                        <p:column headerText="#{msgs.pcc_UM}" width="25" style="text-align: center;" >
                            <h:outputText value="#{p.producto.unidadMedida.unidad}" rendered="#{not empty p.producto}" />
                            <h:outputText value="#{buscadorProductoBean.producto.unidadMedida.unidad}" rendered="#{empty p.producto}"  />
                        </p:column>

                        <p:column headerText="Serie desde" width="70">
                            <p:inputText value="#{p.serdes}" size="10" />

                        </p:column>

                        <p:column headerText="Serie hasta" width="70">
                            <p:inputText value="#{p.serhas}" size="10" />
                        </p:column>

                        <p:column headerText="#{msgs.accion}" width="60" style="text-align: center;">
                            <p:commandButton rendered="#{empty p.producto}"
                                             actionListener="#{parteProduccionBean.agregarItem(p)}" icon="add16"
                                             update="@form"  />

                            <p:commandButton immediate="true" rendered="#{not empty p.producto}"
                                             actionListener="#{parteProduccionBean.eliminarItemProducto(p)}" icon="delete16"
                                             process="@this"
                                             update="@form"  />
                        </p:column>

                    </p:dataTable>

                </p:tab>

                <p:tab title="Parte Proceso" rendered="#{not empty parteProduccionBean.m.parteProceso}">

                    <p:dataTable id="detalle" value="#{parteProduccionBean.m.parteProceso.itemProducto}"
                                 var="p" scrollable="true" scrollHeight="200"
                                 emptyMessage="#{msgs.pcc_msgNoEncontraronProductos}">

                        <p:column headerText="#{msgs.pcc_codigo}" width="120">
                            <h:outputText value="#{p.producto.artcod}" rendered="#{not empty p.producto}"/>
                            <h:outputText value="#{buscadorProductoBean.producto.artcod}" rendered="#{empty p.producto}"  />
                        </p:column>

                        <p:column headerText="#{msgs.pcc_descripcion}" width="380" >
                            <h:outputText value="#{p.producto.descrp}"  rendered="#{not empty p.producto}"/>
                            <h:outputText value="#{buscadorProductoBean.producto.descrp}" rendered="#{empty p.producto}"  />
                        </p:column>

                        <p:column headerText="#{msgs.pcc_cantidad}" width="80">
                            <p:spinner value="#{p.cantid}" size="5" id="cantidad" min="1" >
                                <f:convertNumber pattern="0.00" />
                                <p:ajax listener="#{parteProduccionBean.actualizarCantidades}"
                                        update="cantidad"/>
                            </p:spinner>
                        </p:column>

                        <p:column headerText="#{msgs.pcc_UM}" width="30" style="text-align: center;" >
                            <h:outputText value="#{p.producto.unidadMedida.unidad}" rendered="#{not empty p.producto}" />
                            <h:outputText value="#{buscadorProductoBean.producto.unidadMedida.unidad}" rendered="#{empty p.producto}"  />
                        </p:column>

                        <p:column headerText="Serie desde" width="70">
                            <p:inputText value="#{p.serdes}" size="10" />

                        </p:column>

                        <p:column headerText="Serie hasta" width="70">
                            <p:inputText value="#{p.serhas}" size="10" />
                        </p:column>

                        <p:column headerText="#{msgs.accion}" width="60" style="text-align: center;">
                            <p:commandButton rendered="#{empty p.producto}"
                                             actionListener="#{parteProduccionBean.agregarItem(p)}" icon="add16"
                                             update="@form"  />

                            <p:commandButton immediate="true" rendered="#{not empty p.producto}"
                                             actionListener="#{parteProduccionBean.eliminarItemProducto(p)}" icon="delete16"
                                             process="@this"
                                             update="@form"  />
                        </p:column>

                    </p:dataTable>

                </p:tab>
          

            </p:tabView>

    </h:panelGroup>

</ui:composition>